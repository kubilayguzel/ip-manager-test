<!-- data-entry.html - create-task.js'den tam kopyalandı -->
<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IP Manager - Portföye Marka Kaydı</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <style>
/* create-task.html CSS'sinin tam kopyası */
* { margin: 0; padding: 0; box-sizing: border-box; }
body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; color: #333; display: flex; }

/* Sayfa Yapısı */
.page-wrapper { flex-grow: 1; display: flex; flex-direction: column; height: 100vh; overflow-y: auto; background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%); }
.main-container { width: 100%; padding: 30px; }
.page-header { background: rgba(255,255,255,0.95); padding: 30px; border-radius: 20px; margin-bottom: 30px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); }
.page-title { font-size: 2em; color: #1e3c72; margin-bottom: 10px; }
.page-subtitle { color: #666; font-size: 1.1em; }
.form-container { background: rgba(255,255,255,0.95); padding: 40px; border-radius: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); }
.form-section { border-bottom: 1px solid #e1e8ed; padding-bottom: 25px; margin-bottom: 25px; }
.form-section:last-child { border-bottom: none; }
.section-title { font-size: 1.3em; color: #1e3c72; margin-bottom: 20px; display: flex; justify-content: space-between; align-items: center; }
.form-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 25px; }
.form-group { display: flex; flex-direction: column; }
.form-group.full-width { grid-column: 1 / -1; }
.form-label { margin-bottom: 8px; font-weight: 500; color: #333; }
.form-input, .form-select, .form-textarea { width: 100%; padding: 12px 15px; border: 2px solid #e1e8ed; border-radius: 10px; font-size: 1em; transition: all 0.3s ease; background: #fff; }
.form-input:focus, .form-select:focus, .form-textarea:focus { border-color: #4a90e2; outline: none; box-shadow: 0 0 0 3px rgba(74, 144, 226, 0.1); }
.form-actions { display: flex; justify-content: flex-end; gap: 15px; margin-top: 30px; }
.btn { padding: 12px 25px; border: none; border-radius: 8px; font-size: 1em; font-weight: 600; cursor: pointer; transition: all 0.3s ease; }
.btn-primary { background: #1e3c72; color: #fff; }
.btn-primary:hover { background: #2a5298; transform: translateY(-2px); }
.btn-secondary { background: #6c757d; color: #fff; }
.btn-secondary:hover { background: #545b62; }
.btn-success { background: #28a745; color: #fff; }
.btn-success:hover { background: #218838; transform: translateY(-2px); }

/* Nice Classification Styling - create-task.html'den kopyalandı */
.nice-classification-container { background: #fff; border-radius: 15px; overflow: hidden; margin-top: 20px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); }
.classification-panel { background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%); color: white; }
.panel-header { padding: 20px; text-align: center; }
.search-section { padding: 0 20px 20px; }
.search-results-container { max-height: 500px; overflow-y: auto; background: white; }
.classes-list { padding: 0; }
.class-item { border-bottom: 1px solid #f0f0f0; }
.class-header { padding: 15px 20px; cursor: pointer; display: flex; justify-content: space-between; align-items: center; transition: all 0.3s ease; background: white; }
.class-header:hover { background: #f8f9fa; }
.class-header-content { flex: 1; }
.class-number { background: #4a90e2; color: white; padding: 4px 8px; border-radius: 4px; font-weight: bold; margin-right: 10px; }
.class-title { font-weight: 500; }
.class-header-actions { display: flex; align-items: center; gap: 10px; }
.select-class-btn { background: #6c757d; color: white; border: none; border-radius: 50%; width: 30px; height: 30px; display: flex; align-items: center; justify-content: center; transition: all 0.3s ease; }
.select-class-btn:hover { background: #5a6268; transform: scale(1.1); }
.toggle-icon { transition: transform 0.3s ease; }
.class-header.expanded .toggle-icon { transform: rotate(180deg); }
.subclasses-container { max-height: 0; overflow: hidden; transition: max-height 0.3s ease; background: #fafafa; }
.subclasses-container.show { max-height: 1000px; }
.subclass-item { padding: 10px 20px 10px 40px; cursor: pointer; border-bottom: 1px solid #eee; transition: background 0.2s; }
.subclass-item:hover { background: #e9ecef; }
.subclass-item.selected { background: #e3f2fd; border-left: 3px solid #2196f3; }
.subclass-code { font-weight: bold; color: #666; }
.selected-classes-panel { background: #f8f9fa; border-left: 1px solid #e1e8ed; }
.selected-class-item { background: #e3f2fd; border: 1px solid #90caf9; border-radius: 8px; padding: 10px; margin-bottom: 10px; display: flex; justify-content: space-between; align-items: center; }
.remove-selected-class-btn { background: #f44336; color: white; border: none; border-radius: 4px; width: 24px; height: 24px; display: flex; align-items: center; justify-content: center; font-size: 12px; cursor: pointer; }
.remove-selected-class-btn:hover { background: #d32f2f; }

/* Selected items */
.selected-items-list { min-height: 100px; border: 1px dashed #ced4da; border-radius: 8px; padding: 10px; background: #f8f9fa; overflow-y: auto; max-height: 300px; }
.selected-item { background: #e2f0ff; border: 1px solid #a7d9ff; border-radius: 8px; padding: 8px 12px; margin-bottom: 8px; display: flex; justify-content: space-between; align-items: center; font-size: 0.95rem; color: #343a40; }
.selected-item .remove-selected-item-btn { background: none; border: none; color: #dc3545; font-size: 1.2rem; cursor: pointer; padding: 0 5px; transition: color 0.2s ease; }
.selected-item .remove-selected-item-btn:hover { color: #c82333; }

/* Search results */
.search-results-list { max-height: 200px; overflow-y: auto; border: 1px solid #ced4da; border-top: none; border-radius: 0 0 8px 8px; background: #fff; box-shadow: 0 2px 4px rgba(0,0,0,0.05); position: relative; z-index: 1000; }
.search-result-item { padding: 10px 15px; cursor: pointer; border-bottom: 1px solid #eee; transition: background-color 0.2s ease; }
.search-result-item:hover { background-color: #f0f0f0; }
.search-result-item:last-child { border-bottom: none; }
.no-results-message { padding: 15px; color: #6c757d; text-align: center; }

/* Tab sistemi */
.nav-tabs { border-bottom: 2px solid #e1e8ed; margin-bottom: 0; }
.nav-tabs .nav-link { border: none; border-radius: 10px 10px 0 0; margin-right: 5px; padding: 12px 20px; font-weight: 500; color: #666; background: #f8f9fa; }
.nav-tabs .nav-link.active { background: #fff; color: #1e3c72; font-weight: 600; border-bottom: 2px solid #fff; }
.nav-tabs .nav-link:hover { background: #e9ecef; }

.tab-content-card { padding: 30px; border: 1px solid #e1e8ed; border-top: none; border-radius: 0 0 10px 10px; background: #fff; }

/* File upload */
.brand-upload-frame { border: 2px dashed #4a90e2; border-radius: 10px; padding: 30px; text-align: center; cursor: pointer; transition: all 0.3s ease; background: #f8f9fa; }
.brand-upload-frame:hover, .brand-upload-frame.drag-over { background: #e3f2fd; border-color: #1976d2; }
.upload-icon { font-size: 3em; color: #4a90e2; margin-bottom: 15px; }

/* Preview */
#brandExamplePreviewContainer { margin-top: 20px; text-align: center; display: none; }
#brandExamplePreview { max-width: 200px; max-height: 200px; border: 2px solid #e1e8ed; border-radius: 10px; box-shadow: 0 4px 8px rgba(0,0,0,0.1); }

/* Radio buttons */
.radio-group { display: flex; gap: 20px; margin-top: 8px; }
.radio-option { display: flex; align-items: center; gap: 8px; }
.radio-option input[type="radio"] { margin: 0; }

.empty-state { text-align: center; padding: 30px; color: #666; }
.empty-state i { font-size: 2em; color: #ccc; margin-bottom: 10px; }

/* 35-5 Modal styles */
.class-35-5-modal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 10000; display: none; align-items: center; justify-content: center; animation: fadeIn 0.3s ease; }
.class-35-5-modal-content { background: white; border-radius: 15px; max-width: 95%; max-height: 95%; width: 1200px; height: 700px; display: flex; flex-direction: column; animation: slideIn 0.3s ease; }
.class-35-5-modal-header { background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%); color: white; padding: 20px; border-radius: 15px 15px 0 0; display: flex; justify-content: space-between; align-items: center; }
.class-35-5-modal-body { flex: 1; overflow: hidden; display: flex; flex-direction: column; }
.class-35-5-modal-footer { background: #f8f9fa; padding: 15px 20px; border-radius: 0 0 15px 15px; display: flex; justify-content: flex-end; gap: 15px; }
.close-modal-btn { background: none; border: none; color: white; font-size: 1.5rem; cursor: pointer; }

/* Visual states */
.class-header.selected { background: linear-gradient(135deg, #e8f5e8 0%, #d4edda 100%); border-left: 4px solid #28a745; }
.class-header.partially-selected { background: linear-gradient(135deg, #fff3cd 0%, #ffeaa7 100%); border-left: 4px solid #ffc107; }
.class-header.fully-selected { background: linear-gradient(135deg, #e8f5e8 0%, #d4edda 100%); border-left: 4px solid #28a745; }
.class-header.fully-selected .select-class-btn { background: #28a745; }
.class-header.partially-selected .select-class-btn { background: #ffc107; color: #333; }
.custom-class-wrapper {
    border-left: 4px solid #e74c3c !important;
    transition: all 0.3s ease;
}

.custom-class-wrapper:hover {
    box-shadow: 0 4px 12px rgba(231, 76, 60, 0.15);
}

/* Seçilen sınıfların görünümü */
.selected-class-item {
    background: #fff;
    border: 1px solid #e1e8ed;
    border-radius: 8px;
    padding: 12px;
    margin-bottom: 10px;
    position: relative;
    transition: all 0.3s ease;
}

.selected-class-item:hover {
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    transform: translateY(-1px);
}

.selected-class-item.custom {
    background: linear-gradient(135deg, #fff5f5 0%, #ffeaa7 100%);
    border-color: #e74c3c;
}

.selected-class-number {
    background: #4a90e2;
    color: white;
    padding: 4px 8px;
    border-radius: 4px;
    font-weight: bold;
    font-size: 0.85em;
    display: inline-block;
    margin-bottom: 5px;
}

.selected-class-item.custom .selected-class-number {
    background: #e74c3c;
}

.selected-class-description {
    margin: 8px 0 0 0;
    font-size: 0.9em;
    line-height: 1.4;
    color: #333;
}

.remove-selected-btn {
    position: absolute;
    top: 8px;
    right: 8px;
    background: #dc3545;
    color: white;
    border: none;
    border-radius: 50%;
    width: 24px;
    height: 24px;
    font-size: 12px;
    cursor: pointer;
    transition: all 0.3s ease;
}

.remove-selected-btn:hover {
    background: #c82333;
    transform: scale(1.1);
}

/* Accordion düzeltmeleri */
.subclasses-container.show {
    max-height: 2000px !important;
    overflow: visible;
}

.subclass-item {
    transition: all 0.3s ease;
}

.subclass-item:hover {
    background: #f8f9fa !important;
    padding-left: 45px;
}

.subclass-item.selected {
    background: linear-gradient(135deg, #e8f5e8 0%, #d4edda 100%) !important;
    color: #155724;
    font-weight: 500;
    border-left: 3px solid #28a745;
}

.subclass-item.selected::before {
    content: "✓";
    position: absolute;
    left: 20px;
    color: #28a745;
    font-weight: bold;
}
    </style>
</head>
<body>
    <div id="layout-placeholder"></div>

    <div class="page-wrapper">
        <main class="main-container">
            <!-- Page Header -->
            <section class="page-header">
                <h1 class="page-title">Portföye Yeni Marka Kaydı</h1>
                <p class="page-subtitle">Yeni bir marka başvurusu oluşturun ve portföyünüze ekleyin.</p>
            </section>

            <!-- Form Container -->
            <div class="form-container">
                <!-- Bu container create-task.js tarafından doldurulacak -->
                <div id="conditionalFieldsContainer">
                    <!-- Tabs -->
                    <ul class="nav nav-tabs" id="myTaskTabs" role="tablist">
                        <li class="nav-item">
                            <a class="nav-link active" id="brand-info-tab" data-toggle="tab" href="#brand-info" role="tab">Marka Bilgileri</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" id="goods-services-tab" data-toggle="tab" href="#goods-services" role="tab">Mal/Hizmet Seçimi</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" id="applicants-tab" data-toggle="tab" href="#applicants" role="tab">Başvuru Sahipleri</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" id="priority-tab" data-toggle="tab" href="#priority" role="tab">Rüçhan</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" id="summary-tab" data-toggle="tab" href="#summary" role="tab">Özet</a>
                        </li>
                    </ul>

                    <!-- Tab Content -->
                    <div class="tab-content mt-3 tab-content-card" id="myTaskTabContent">
                        <!-- Marka Bilgileri, Başvuru Sahibi, Rüçhan, Özet tabları create-task.js tarafından doldurulacak -->

                        <!-- Mal/Hizmet Seçimi Tab -->
                        <div class="tab-pane fade" id="goods-services" role="tabpanel">
                            <div class="nice-classification-container mt-3">
                                <div class="row">
                                    <div class="col-lg-8">
                                        <div class="classification-panel mb-3">
                                            <div class="panel-header">
                                                <h5 class="mb-0">
                                                    <i class="fas fa-list-ul mr-2"></i>
                                                    Nice Classification - Mal ve Hizmet Sınıfları
                                                </h5>
                                                <small class="text-white-50">1-45 arası sınıflardan seçim yapın</small>
                                            </div>
                                            
                                            <div class="search-section">
                                                <div class="input-group">
                                                    <div class="input-group-prepend">
                                                        <span class="input-group-text">
                                                            <i class="fas fa-search"></i>
                                                        </span>
                                                    </div>
                                                    <input type="text" class="form-control" id="niceClassSearch" 
                                                        placeholder="Sınıf ara... (örn: kozmetik, kimyasal, teknoloji)">
                                                    <div class="input-group-append">
                                                        <button class="btn btn-outline-secondary" type="button" onclick="clearNiceSearch()">
                                                            <i class="fas fa-times"></i>
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div class="search-results-container">
                                            <div id="niceClassificationList" class="classes-list">
                                                <div class="text-center p-4">
                                                    <div class="spinner-border text-primary" role="status"></div>
                                                    <p class="mt-2 text-muted">Nice sınıfları yükleniyor...</p>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- 99. SINIF EKLEME BÖLÜMÜ - EKSIK OLAN KISIM -->
                                        <div class="custom-class-wrapper mt-3" style="background: #fff5f5; border: 1px solid #feb2b2; border-radius: 8px; padding: 15px;">
                                            <h6 class="mb-3" style="color: #e74c3c;">
                                                <i class="fas fa-plus-circle mr-2"></i>
                                                99. Sınıf - Özel Kategori Ekle
                                            </h6>
                                            <div class="form-group mb-3">
                                                <label for="customClassInput" class="form-label">Özel Kategori Açıklaması</label>
                                                <div class="input-group">
                                                    <textarea 
                                                        id="customClassInput" 
                                                        class="form-control" 
                                                        rows="2" 
                                                        placeholder="Özel kategori açıklamanızı buraya yazın... (Maksimum 500 karakter)"
                                                        maxlength="500"
                                                        style="resize: vertical; min-height: 60px;"></textarea>
                                                    <div class="input-group-append">
                                                        <button 
                                                            id="addCustomClassBtn" 
                                                            class="btn btn-outline-danger" 
                                                            type="button"
                                                            title="99. Sınıf Ekle">
                                                            <i class="fas fa-plus"></i>
                                                            Ekle
                                                        </button>
                                                    </div>
                                                </div>
                                                <small class="text-muted">
                                                    <span id="customClassCharCount">0</span>/500 karakter
                                                </small>
                                            </div>
                                            <div class="alert alert-info py-2 px-3 mb-0" style="font-size: 0.9em;">
                                                <i class="fas fa-info-circle mr-1"></i>
                                                99. sınıf, standart Nice sınıflarına girmeyen özel kategoriler için kullanılır.
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="col-lg-4">
                                        <div class="selected-classes-panel">
                                            <div class="panel-header text-center p-3 bg-success text-white">
                                                <h6 class="mb-0">
                                                    <i class="fas fa-check-circle mr-2"></i>
                                                    Seçilen Sınıflar (<span id="selectedClassCount">0</span>)
                                                </h6>
                                            </div>
                                            <div id="selectedNiceClasses" class="p-3" style="max-height: 400px; overflow-y: auto;">
                                                <div class="empty-state">
                                                    <i class="fas fa-list-alt fa-3x text-muted mb-3"></i>
                                                    <p class="text-muted">
                                                        Henüz hiçbir sınıf seçilmedi.<br>
                                                        Sol panelden sınıf başlığına veya alt sınıfları seçin.
                                                    </p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Form Actions -->
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" onclick="window.location.href='portfolio.html'">
                        <i class="fas fa-times mr-2"></i>İptal
                    </button>
                    <button type="button" id="saveTaskBtn" class="btn btn-success" disabled>
                        <i class="fas fa-save mr-2"></i>Portföye Kaydet
                    </button>
                </div>
            </div>
        </main>
    </div>

    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.4/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <script type="module" src="./js/data-entry.js"></script>
</body>
</html>