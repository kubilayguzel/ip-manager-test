<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>IP Manager – Portföye Marka Kaydı</title>

  <!-- Bootstrap & FontAwesome -->
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"/>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css"/>
<style>
/* create-task.html CSS'sinin tam kopyası + Nice Classification düzeltmeleri */
* { margin: 0; padding: 0; box-sizing: border-box; }
body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; color: #333; display: flex; }

/* Sayfa Yapısı */
.page-wrapper { flex-grow: 1; display: flex; flex-direction: column; height: 100vh; overflow-y: auto; background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%); }
.main-container { width: 100%; padding: 30px; }
.page-header { background: rgba(255,255,255,0.95); padding: 30px; border-radius: 20px; margin-bottom: 30px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); }
.page-title { font-size: 2em; color: #1e3c72; margin-bottom: 10px; }
.page-subtitle { color: #666; font-size: 1.1em; }
.form-container { background: rgba(255,255,255,0.95); padding: 40px; border-radius: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); }
.form-section { border-bottom: 1px solid #e1e8ed; padding-bottom: 25px; margin-bottom: 25px; }
.form-section:last-child { border-bottom: none; }
.section-title { font-size: 1.3em; color: #1e3c72; margin-bottom: 20px; display: flex; justify-content: space-between; align-items: center; }
.form-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 25px; }
.form-group { display: flex; flex-direction: column; }
.form-group.full-width { grid-column: 1 / -1; }
.form-label { margin-bottom: 8px; font-weight: 500; color: #333; }
.form-input, .form-select, .form-textarea { width: 100%; padding: 12px 15px; border: 2px solid #e1e8ed; border-radius: 10px; font-size: 1em; transition: all 0.3s ease; background: #fff; }
.form-input:focus, .form-select:focus, .form-textarea:focus { border-color: #4a90e2; outline: none; box-shadow: 0 0 0 3px rgba(74, 144, 226, 0.1); }
.form-actions { display: flex; justify-content: flex-end; gap: 15px; margin-top: 30px; }
.btn { padding: 12px 25px; border: none; border-radius: 8px; font-size: 1em; font-weight: 600; cursor: pointer; transition: all 0.3s ease; }
.btn-primary { background: #1e3c72; color: #fff; }
.btn-primary:hover { background: #2a5298; transform: translateY(-2px); }
.btn-secondary { background: #6c757d; color: #fff; }
.btn-secondary:hover { background: #545b62; }
.btn-success { background: #28a745; color: #fff; }
.btn-success:hover { background: #218838; transform: translateY(-2px); }

/* Tab Navigation */
.nav-tabs { border: none; margin-bottom: 30px; }
.nav-tabs .nav-link { border: none; border-radius: 10px 10px 0 0; background: #f8f9fa; color: #666; margin-right: 5px; padding: 15px 25px; font-weight: 500; transition: all 0.3s ease; }
.nav-tabs .nav-link:hover { background: #e9ecef; color: #333; }
.nav-tabs .nav-link.active { background: #1e3c72; color: #fff; box-shadow: 0 -5px 15px rgba(30, 60, 114, 0.3); }
.tab-content { background: #fff; padding: 30px; border-radius: 15px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); }

/* Radio Button Styling */
.radio-group { display: flex; gap: 20px; flex-wrap: wrap; }
.radio-option { display: flex; align-items: center; }
.radio-option input[type="radio"] { margin-right: 8px; }
.radio-option label { cursor: pointer; }

/* Nice Classification Styling - create-task.html'den kopyalandı + düzeltmeler */
.nice-classification-container { background: #fff; border-radius: 15px; overflow: hidden; margin-top: 20px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); }
.classification-panel { background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%); color: white; }
.panel-header { padding: 20px; text-align: center; }
.search-section { padding: 0 20px 20px; }
.search-results-container { max-height: 500px; overflow-y: auto; background: white; }
.classes-list { padding: 0; }
.class-item { border-bottom: 1px solid #f0f0f0; }
.class-header { padding: 15px 20px; cursor: pointer; display: flex; justify-content: space-between; align-items: center; transition: all 0.3s ease; background: white; }
.class-header:hover { background: #f8f9fa; }
.class-header-content { flex: 1; }
.class-number { background: #4a90e2; color: white; padding: 4px 8px; border-radius: 4px; font-weight: bold; margin-right: 10px; }
.class-title { font-weight: 500; }
.class-header-actions { display: flex; align-items: center; gap: 10px; }
.select-class-btn { background: #6c757d; color: white; border: none; border-radius: 50%; width: 30px; height: 30px; display: flex; align-items: center; justify-content: center; transition: all 0.3s ease; }
.select-class-btn:hover { background: #5a6268; transform: scale(1.1); }
.toggle-icon { transition: transform 0.3s ease; }
.class-header.expanded .toggle-icon { transform: rotate(180deg); }
.subclasses-container { max-height: 0; overflow: hidden; transition: max-height 0.3s ease; background: #fafafa; }
.subclasses-container.show { max-height: 1000px; }
.subclass-item { padding: 10px 20px 10px 40px; cursor: pointer; transition: all 0.3s ease; border-bottom: 1px solid #f1f3f4; position: relative; }
.subclass-item:hover { background: #f8f9fa; transform: translateX(5px); }
.subclass-item.selected { background: linear-gradient(135deg, #e8f5e8 0%, #d4edda 100%); color: #155724; font-weight: 500; border-left: 3px solid #28a745; }
.subclass-item.selected::before { content: "✓"; position: absolute; left: 20px; top: 50%; transform: translateY(-50%); color: #28a745; font-weight: bold; }
.subclass-code { font-weight: 600; color: #495057; }
.subclass-item.selected .subclass-code { color: #155724; }

/* Ana sınıf seçili değil (varsayılan) -> beyaz */
.class-header { background: white; }

/* En az 1 alt sınıf seçili ama hepsi değil -> sarı */
.class-header.partially-selected {
    background: linear-gradient(135deg, #fff3cd 0%, #ffeaa7 100%);
    border-left: 4px solid #ffc107;
}

/* Tüm alt sınıflar veya ana sınıf seçili -> yeşil */
.class-header.fully-selected {
    background: linear-gradient(135deg, #e8f5e8 0%, #d4edda 100%);
    border-left: 4px solid #28a745;
}

/* Duruma göre tik rengi değişsin */
.class-header.fully-selected .select-class-btn { background: #28a745; }
.class-header.partially-selected .select-class-btn { background: #ffc107; color: #333; }

/* 99. Sınıf Frame Stilleri - create-task.html'den kopyalandı */
.custom-class-frame {
    margin-top: 20px;
    background: #fff5f5;
    border: 1px solid #feb2b2;
    border-radius: 8px;
    padding: 15px;
    box-shadow: 0 2px 6px rgba(0,0,0,0.05);
}

.custom-class-section .badge-danger {
    background-color: #dc3545 !important;
}

.custom-class-section strong.text-danger {
    color: #dc3545 !important;
}

.custom-class-section .btn-danger {
    background-color: #dc3545;
    border-color: #dc3545;
}

.custom-class-section .btn-danger:hover {
    background-color: #c82333;
    border-color: #bd2130;
}

/* Seçilen sınıflar panel stilleri */
.selected-classes-panel {
    background: #fff;
    border: 1px solid #dee2e6;
    border-radius: 12px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    display: flex;
    flex-direction: column;
    height: fit-content;
    max-height: 700px;
}

.selected-class-item {
    background: #fff;
    border: 1px solid #e1e8ed;
    border-radius: 8px;
    padding: 12px;
    margin-bottom: 10px;
    position: relative;
    transition: all 0.3s ease;
}

.selected-class-item:hover {
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    transform: translateY(-1px);
}

.selected-class-item.custom {
    background: linear-gradient(135deg, #fff5f5 0%, #ffe6e6 100%);
    border-color: #dc3545;
    border-left: 4px solid #dc3545;
}

.selected-class-number {
    background: #4a90e2;
    color: white;
    padding: 4px 8px;
    border-radius: 4px;
    font-weight: bold;
    font-size: 0.85em;
    display: inline-block;
    margin-bottom: 5px;
}

.selected-class-item.custom .selected-class-number {
    background: #dc3545;
}

.selected-class-description {
    margin: 8px 0 0 0;
    font-size: 0.9em;
    line-height: 1.4;
    color: #333;
    word-wrap: break-word;
}

.remove-selected-btn {
    position: absolute;
    top: 8px;
    right: 8px;
    background: #dc3545;
    color: white;
    border: none;
    border-radius: 50%;
    width: 24px;
    height: 24px;
    font-size: 12px;
    cursor: pointer;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    justify-content: center;
}

.remove-selected-btn:hover {
    background: #c82333;
    transform: scale(1.1);
}

/* Empty state stilleri */
.empty-state {
    text-align: center;
    padding: 40px 20px;
}

.empty-state .fa-list-alt {
    opacity: 0.3;
}

.empty-state p {
    margin-bottom: 0;
    font-size: 0.9em;
}

/* Karakter sayacı */
#customClassCharCount {
    font-weight: 500;
}

/* Panel header güzelleştirme */
.selected-classes-panel .panel-header {
    background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
    border-radius: 12px 12px 0 0;
}

.selected-classes-panel .panel-header h6 {
    font-weight: 600;
    margin: 0;
}

/* Person Search & Selection */
.search-result-item {
    padding: 10px;
    cursor: pointer;
    border-bottom: 1px solid #eee;
}

.search-result-item:hover {
    background-color: #f8f9fa;
}

.result-name {
    font-weight: 500;
    color: #333;
}

.result-details {
    font-size: 0.85em;
    color: #666;
    margin-top: 2px;
}

.selected-person-item {
    background: #fff;
    border: 1px solid #e1e8ed;
    border-radius: 8px;
    padding: 12px;
    margin-bottom: 10px;
    position: relative;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.person-info {
    flex: 1;
}

.remove-person-btn {
    background: #dc3545;
    color: white;
    border: none;
    border-radius: 50%;
    width: 24px;
    height: 24px;
    font-size: 12px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
}

.remove-person-btn:hover {
    background: #c82333;
}

/* Search Results Container */
.search-results-container {
    position: absolute;
    top: 100%;
    left: 0;
    right: 0;
    background: white;
    border: 1px solid #ddd;
    border-radius: 0 0 8px 8px;
    max-height: 200px;
    overflow-y: auto;
    z-index: 1000;
    display: none;
}

.person-search-wrapper {
    position: relative;
}

/* Responsive düzeltmeler */
@media (max-width: 991px) {
    .nice-classification-container .row {
        flex-direction: column;
    }
    
    .selected-classes-panel {
        margin-top: 20px;
        max-height: 400px;
    }
    
    .classes-list {
        height: 350px !important;
    }
    
    .form-grid {
        grid-template-columns: 1fr;
    }
}

/* Loading & Error States */
.loading-spinner {
    text-align: center;
    padding: 40px 20px;
}

.error-state {
    text-align: center;
    padding: 40px 20px;
    color: #dc3545;
}

/* Animasyonlar */
@keyframes fadeIn { from {opacity:0;} to {opacity:1;} }
@keyframes slideIn { from {opacity:0;transform:translateY(-20px);} to {opacity:1;transform:translateY(0);} }

.selected-class-item, .selected-person-item {
    animation: slideIn 0.3s ease;
}
/* Nice Classification listesinde başlık ve alt sınıf metinlerini koyu renk yap */
.classes-list .class-header,
.classes-list .class-header .class-title,
.classes-list .subclass-item {
  color: #212529 !important;
}
/* ---- Flex düzeni ---- */
  .nice-classification-container {
    display: flex;
    gap: 20px;
  }
  .classification-panel {
    flex: 2;
  }
  .selected-classes-panel {
    flex: 1;
    display: flex;
    flex-direction: column;
  }
  /* Sağ paneldeki listeyi taşırmak için */
  .selected-classes-panel .selected-list {
    overflow-y: auto;
  }
.selected-classes-panel {
  display: flex;
  flex-direction: column;
  height: 100%;
}

/* Listeyi kalan tüm boşluğu kaplayacak şekilde ayarla */
.selected-list {
  overflow-y: auto;
  flex: 1 1 auto;
}

/* (Opsiyonel) Daha rahat scroll için thumb genişliği */
.selected-list::-webkit-scrollbar {
  width: 8px;
}
.selected-list::-webkit-scrollbar-thumb {
  background-color: rgba(0,0,0,0.2);
  border-radius: 4px;
}
#selectedNiceClasses {
  max-height: 500px !important;  /* sol paneldeki max-height ile aynı */
}
</style>
</head>
<body>
<div id="layout-placeholder"></div>
<div class="page-wrapper">
    <div class="main-container">
      <div class="page-header">
        <h1 class="page-title"><i class="fas fa-plus-circle mr-2"></i>Portföye Marka Kaydı</h1>
        <p class="page-subtitle">Yeni bir marka başvurusu oluşturun ve portföyünüze ekleyin</p>
      </div>

      <div class="form-container">
        <!-- Nav Tabs -->
        <ul class="nav nav-tabs" id="myTaskTabs" role="tablist">
          <li class="nav-item">
            <a class="nav-link active" id="brand-info-tab" data-toggle="tab"
               href="#brand-info" role="tab" aria-controls="brand-info" aria-selected="true">
              Marka Bilgileri
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" id="goods-services-tab" data-toggle="tab"
               href="#goods-services" role="tab" aria-controls="goods-services" aria-selected="false">
              Mal/Hizmet Seçimi
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" id="applicants-tab" data-toggle="tab"
               href="#applicants" role="tab" aria-controls="applicants" aria-selected="false">
              Başvuru Sahibi
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" id="priority-tab" data-toggle="tab"
               href="#priority" role="tab" aria-controls="priority" aria-selected="false">
              Rüçhan
            </a>
          </li>
        </ul>

        <!-- Tab Content -->
        <div class="tab-content mt-3" id="myTaskTabContent">

          <!-- 1. Marka Bilgileri -->
          <div class="tab-pane fade show active" id="brand-info" role="tabpanel" aria-labelledby="brand-info-tab">
            <div class="form-section">
              <h3 class="section-title">Marka Bilgileri</h3>
              <div class="form-group row">
                <label for="brandType" class="col-sm-3 col-form-label">Marka Tipi</label>
                <div class="col-sm-9">
                  <select class="form-control" id="brandType">
                    <option value="Sadece Kelime">Sadece Kelime</option>
                    <option value="Sadece Şekil">Sadece Şekil</option>
                    <option value="Şekil + Kelime" selected>Şekil + Kelime</option>
                    <option value="Ses">Ses</option>
                    <option value="Hareket">Hareket</option>
                    <option value="Renk">Renk</option>
                    <option value="Üç Boyutlu">Üç Boyutlu</option>
                  </select>
                </div>
              </div>
              <div class="form-group row">
                <label for="brandCategory" class="col-sm-3 col-form-label">Marka Türü</label>
                <div class="col-sm-9">
                  <select class="form-control" id="brandCategory">
                    <option value="Ticaret/Hizmet Markası" selected>Ticaret/Hizmet Markası</option>
                    <option value="Garanti Markası">Garanti Markası</option>
                    <option value="Ortak Marka">Ortak Marka</option>
                  </select>
                </div>
              </div>
              <div class="form-group row">
                <label for="brandExampleText" class="col-sm-3 col-form-label">Marka Örneği Yazılı İfadesi</label>
                <div class="col-sm-9">
                  <input type="text" class="form-control" id="brandExampleText">
                </div>
              </div>
              <!-- Diğer marka bilgisi alanlarınız… -->
            </div>
          </div>

          <!-- 2. Mal/Hizmet Seçimi -->
          <div class="tab-pane fade" id="goods-services" role="tabpanel" aria-labelledby="goods-services-tab">
            <div class="nice-classification-container mt-3">
              <div class="row">
                <!-- Sol Panel: Sınıf Listesi -->
                <div class="col-lg-8">
                  <div class="classification-panel mb-3">
                    <div class="panel-header">
                      <h5 class="mb-0"><i class="fas fa-list-ul mr-2"></i>Nice Classification – Mal ve Hizmet Sınıfları</h5>
                    </div>
                    <div class="search-section p-3">
                      <div class="input-group">
                        <div class="input-group-prepend">
                          <span class="input-group-text"><i class="fas fa-search"></i></span>
                        </div>
                        <input type="text" class="form-control" id="niceClassSearch" placeholder="Sınıf ara…">
                        <div class="input-group-append">
                          <button class="btn btn-outline-secondary" type="button" onclick="clearNiceSearch()">
                            <i class="fas fa-times"></i>
                          </button>
                        </div>
                      </div>
                    </div>
                    <div class="classes-list" id="niceClassificationList"
                         style="height:450px; overflow-y:auto; background:#fafafa;">
                      <div class="loading-spinner text-center p-4">
                        <div class="spinner-border text-primary" role="status"></div>
                        <p class="mt-2 text-muted">Yükleniyor…</p>
                      </div>
                    </div>
                  </div>
                  <!-- 99. Sınıf Özel Tanım -->
                  <div class="custom-class-frame p-3">
                    <div class="d-flex align-items-center mb-2">
                      <span class="badge badge-danger mr-2">99</span>
                      <strong>Özel Tanım</strong>
                    </div>
                    <textarea class="form-control mb-2" id="customClassInput"
                              rows="3" placeholder="Özel tanım…"></textarea>
                    <button class="btn btn-danger" id="addCustomClassBtn">
                      <i class="fas fa-plus mr-1"></i>99. Sınıf Ekle
                    </button>
                    <small class="text-muted d-block mt-1">
                      <span id="customClassCharCount">0</span>/50000
                    </small>
                  </div>
                </div>

                <!-- Sağ Panel: Seçilen Sınıflar -->
                <div class="col-lg-4">
                  <div class="selected-classes-panel d-flex flex-column" style="height:100%;">
                    <div class="panel-header d-flex justify-content-between align-items-center p-3 bg-success text-white">
                      <h6 class="mb-0">
                        <i class="fas fa-check-circle mr-2"></i>Seçilen Sınıflar (<span id="selectedClassCount">0</span>)
                      </h6>
                      <button id="clearAllClassesBtn" class="btn btn-outline-light btn-sm">Tümünü Sil</button>
                    </div>
                    <div id="selectedNiceClasses" class="selected-list flex-grow-1 p-3" style="overflow-y:auto;">
                      <div class="empty-state text-center">
                        <i class="fas fa-list-alt fa-3x text-muted mb-3"></i>
                        <p class="text-muted">Henüz sınıf seçilmedi.</p>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- 3. Başvuru Sahibi -->
          <div class="tab-pane fade" id="applicants" role="tabpanel" aria-labelledby="applicants-tab">
            <div class="form-section">
              <h3 class="section-title">Başvuru Sahibi Bilgileri</h3>
              <div class="form-group">
                <label for="applicantSearchInput" class="form-label">Başvuru Sahibi Ara</label>
                <div class="input-group mb-3">
                  <input type="text" id="applicantSearchInput" class="form-control" placeholder="En az 2 karakter…">
                  <div class="input-group-append">
                    <button id="addNewApplicantBtn" class="btn btn-primary">
                      <i class="fas fa-user-plus mr-1"></i>Yeni Kişi
                    </button>
                  </div>
                </div>
                <div id="applicantSearchResults" class="search-results-list"></div>
              </div>
              <div class="form-group mt-4">
                <label class="form-label">Seçilen Başvuru Sahipleri</label>
                <div id="selectedApplicantsList" class="selected-items-list">
                  <div class="empty-state text-center">
                    <i class="fas fa-user-plus fa-3x text-muted mb-3"></i>
                    <p class="text-muted">Henüz başvuru sahibi seçilmedi.</p>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- 4. Rüçhan -->
          <div class="tab-pane fade" id="priority" role="tabpanel" aria-labelledby="priority-tab">
            <div class="form-section">
              <h3 class="section-title">Rüçhan Bilgileri</h3>
              <div class="form-group row">
                <label for="priorityType" class="col-sm-3 col-form-label">Rüçhan Tipi</label>
                <div class="col-sm-9">
                  <select class="form-control" id="priorityType">
                    <option value="başvuru" selected>Başvuru</option>
                    <option value="sergi">Sergi</option>
                  </select>
                </div>
              </div>
              <div class="form-group row">
                <label for="priorityDate" id="priorityDateLabel" class="col-sm-3 col-form-label">Rüçhan Tarihi</label>
                <div class="col-sm-9">
                  <input type="date" class="form-control" id="priorityDate">
                </div>
              </div>
              <div class="form-group row">
                <label for="priorityCountry" class="col-sm-3 col-form-label">Rüçhan Ülkesi</label>
                <div class="col-sm-9">
                  <select class="form-control" id="priorityCountry">
                    <option value="">Seçiniz</option>
                    <option value="TR">Türkiye</option>
                    <option value="US">ABD</option>
                    <option value="DE">Almanya</option>
                  </select>
                </div>
              </div>
              <div class="form-group row">
                <label for="priorityNumber" class="col-sm-3 col-form-label">Rüçhan Numarası</label>
                <div class="col-sm-9">
                  <input type="text" class="form-control" id="priorityNumber" placeholder="Örn: 2023/12345">
                </div>
              </div>
              <div class="form-group text-right">
                <button type="button" id="addPriorityBtn" class="btn btn-secondary">
                  <i class="fas fa-plus mr-1"></i>Rüçhan Ekle
                </button>
              </div>
              <hr>
              <div class="form-group">
                <label class="form-label">Eklenen Rüçhan Hakları</label>
                <div id="addedPrioritiesList" class="selected-items-list">
                  <div class="empty-state text-center">
                    <i class="fas fa-info-circle fa-3x text-muted mb-3"></i>
                    <p class="text-muted">Henüz rüçhan bilgisi eklenmedi.</p>
                  </div>
                </div>
              </div>
            </div>
          </div>

        </div> <!-- /tab-content -->

        <div class="form-actions mt-4">
          <button type="button" class="btn btn-secondary" onclick="history.back()">
            <i class="fas fa-arrow-left mr-2"></i>İptal
          </button>
          <button type="submit" id="saveTaskBtn" class="btn btn-success">
            <i class="fas fa-save mr-2"></i>Marka Başvurusunu Kaydet
          </button>
        </div>
      </div> <!-- /form-container -->
    </div> <!-- /main-container -->
  </div> <!-- /page-wrapper -->

  <!-- JS Libraries -->
  <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
  <!-- Custom Scripts -->
  <script type="module" src="./js/layout-loader.js"></script>
  <script type="module" src="./js/nice-classification.js"></script>
  <script type="module" src="./js/data-entry.js"></script>
</body>
</html>